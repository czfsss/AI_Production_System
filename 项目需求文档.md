# 智能设备监控与维修辅助系统 - 项目需求文档

## 1. 项目概述

### 1.1 项目背景
本项目旨在开发一个智能设备监控与维修辅助系统，通过实时监控设备运行状态，提供故障诊断、维修建议和工艺知识问答功能，提高设备维护效率和故障处理能力。

### 1.2 项目目标
- 实现设备状态的实时监控与故障预警
- 提供智能化的维修建议和原因分析
- 构建便捷的故障问答交互界面
- 整合工艺知识库，支持工艺标准查询
- 为后续备件库管理功能预留接口

### 1.3 项目范围
系统包含三个核心模块：
1. 设备监控模块
2. 辅助维修模块
3. 工艺知识问答模块

## 2. 系统架构

### 2.1 技术架构
```
前端：Vue.js + Markdown渲染器
后端：Dify平台（API服务）
数据库：TDengine（设备实时数据存储） + MySQL（报警记录和业务数据存储）
知识库：Dify平台知识库功能
```

### 2.2 数据流程
1. 设备数据 → TDengine → Python监控脚本 → 故障检测
2. 故障触发 → Dify API调用 → 知识库推理 → 维修建议
3. 用户查询 → 前端界面 → Dify API → 智能回答
4. 工艺查询 → 前端界面 → Dify API → 知识库检索

## 3. 功能需求

### 3.1 设备监控模块

#### 3.1.1 实时监控
- **功能描述**：实时监控设备运行状态，包括运行参数、运行时间、停机状态等
- **技术实现**：
  - Python脚本连接TDengine数据库
  - 定时查询设备状态数据
  - 实时更新监控界面
- **界面要求**：
  - 设备状态列表（运行/停机/故障）
  - 关键参数实时显示
  - 状态变化时间轴
  - 异常状态高亮显示

#### 3.1.2 故障检测与通知
- **功能描述**：自动检测设备故障，触发通知机制
- **技术实现**：
  - 设定故障判断逻辑
  - 监控脚本检测到故障时自动触发API调用
  - 调用Dify平台的故障分析接口
- **业务规则**：
  - 故障判定规则可配置
  - 支持多种故障类型识别
  - 故障信息包含：设备ID、故障时间、故障代码、故障描述

#### 3.1.3 故障分析与建议
- **功能描述**：结合知识库提供故障原因分析和维修建议
- **技术实现**：
  - 故障信息发送至Dify平台
  - Dify调用知识库进行分析推理
  - 返回结构化的分析结果和建议
- **输出内容**：
  - 故障可能原因列表（按概率排序）
  - 详细原因分析
  - 维修建议步骤
  - 所需工具和备件清单

#### 3.1.4 今日报警记录
- **功能描述**：展示当日所有设备报警记录，支持查看历史报警信息
- **技术实现**：
  - 从MySQL数据库查询报警记录
  - 实时更新报警状态
  - 支持报警记录的筛选和搜索
- **界面要求**：
  - 报警记录列表（时间倒序排列）
  - 报警级别标识（紧急/重要/一般）
  - 报警状态显示（未处理/处理中/已处理）
  - 支持按设备、时间、级别筛选
  - 报警详情查看功能
- **数据存储**：
  - MySQL数据库存储报警记录
  - 包含字段：报警ID、设备ID、报警时间、报警级别、报警内容、处理状态、处理人、处理时间

### 3.2 辅助维修模块

#### 3.2.1 故障问答功能
- **功能描述**：用户输入故障现象或问题，系统提供智能回答
- **技术实现**：
  - 前端提供问答输入界面
  - 调用Dify平台的问答API
  - 支持多轮对话
- **界面要求**：
  - 问答输入框
  - 历史问答记录
  - 回答内容支持Markdown格式
  - 支持追问和澄清

#### 3.2.2 备件库查询（预留功能）
- **功能描述**：查询备件库存信息（占位功能，后续整合）
- **技术实现**：
  - 预留备件库API接口
  - 模拟数据展示界面
- **界面要求**：
  - 备件查询输入框
  - 备件列表展示
  - 库存状态显示
  - 占位提示信息

### 3.3 工艺知识问答模块

#### 3.3.1 工艺标准查询
- **功能描述**：用户可查询相关工艺标准和规范
- **技术实现**：
  - 前端提供工艺查询界面
  - 调用Dify平台的知识库查询API
  - 支持自然语言查询
- **查询范围**：
  - 工艺标准文档
  - 操作规程
  - 质量标准
  - 安全规范

#### 3.3.2 缺陷考核方案查询
- **功能描述**：查询产品缺陷的考核标准和处理方案
- **技术实现**：
  - 集成缺陷知识库
  - 支持缺陷描述查询
  - 提供考核标准和处理建议
- **输出内容**：
  - 缺陷分类和定义
  - 考核标准
  - 处理方案
  - 预防措施

## 4. 技术需求

### 4.1 前端技术要求

#### 4.1.1 技术栈
- **框架**：Vue.js 3.x
- **UI组件库**：Element Plus 或 Ant Design Vue
- **状态管理**：Pinia
- **路由**：Vue Router
- **HTTP客户端**：Axios
- **Markdown渲染**：
  - 使用 `markdown-it` 作为核心解析器
  - 配置 `highlight.js` 进行代码高亮
  - 自定义插件实现表格样式增强

#### 4.1.2 Markdown渲染要求
- **表格样式**：
  - 添加完整边框
  - 实现斑马线样式（隔行变色）
  - 鼠标悬停行高亮显示
  - 表头固定样式
- **代码块**：
  - 语法高亮
  - 复制按钮
  - 语言标识
- **其他元素**：
  - 支持TOC目录生成
  - 数学公式渲染（可选）
  - 流程图和图表支持（可选）

#### 4.1.3 响应式设计
- 支持桌面端和平板端访问
- 自适应布局
- 触摸操作优化

### 4.2 后端技术要求

#### 4.2.1 Dify平台集成
- **API调用**：
  - 统一的API封装
  - 错误处理和重试机制
  - 请求/响应日志记录
- **对话管理**：
  - 会话状态维护
  - 上下文传递
  - 多轮对话支持

#### 4.2.2 TDengine数据集成
- **数据查询**：
  - Python脚本定时查询
  - 连接池管理
  - 查询性能优化
- **数据处理**：
  - 数据清洗和转换
  - 异常检测算法
  - 状态判断逻辑

### 4.3 数据库要求
- **TDengine配置**：
  - 设备数据表结构
  - 索引优化
  - 数据保留策略
- **MySQL配置**：
  - 报警记录表结构设计
  - 业务数据表结构（用户、权限、配置等）
  - 主从复制和读写分离
  - 定期备份和恢复策略
- **数据安全**：
  - 访问权限控制
  - 数据加密传输
  - 备份策略
- **数据同步**：
  - TDengine到MySQL的数据同步机制
  - 故障数据实时同步到报警记录表

## 5. 界面设计要求

### 5.1 整体UI风格

#### 5.1.1 设计理念
- **简洁专业**：采用现代化的扁平设计风格
- **工业风格**：体现工业系统的专业性和可靠性
- **易用性**：操作流程简单直观，信息层次清晰

#### 5.1.2 色彩方案
- **主色调**：
  - 深蓝色 (#1E3A8A)：体现专业和稳定
  - 科技蓝 (#3B82F6)：强调科技感
- **辅助色**：
  - 成功绿 (#10B981)：正常运行状态
  - 警告黄 (#F59E0B)：预警状态
  - 危险红 (#EF4444)：故障状态
- **中性色**：
  - 深灰 (#1F2937)：主要文字
  - 中灰 (#6B7280)：次要文字
  - 浅灰 (#F3F4F6)：背景色

#### 5.1.3 字体规范
- **中文字体**：思源黑体 / 微软雅黑
- **英文字体**：Inter / Roboto
- **字号层级**：
  - 页面标题：24px
  - 模块标题：20px
  - 子标题：16px
  - 正文：14px
  - 辅助文字：12px

### 5.2 布局结构

#### 5.2.1 整体布局
- **顶部导航栏**：
  - 系统Logo和名称
  - 主要功能模块导航
  - 用户信息和设置
- **侧边栏**（可选）：
  - 快捷功能入口
  - 系统状态概览
- **主内容区**：
  - 功能模块内容
  - 数据展示和操作区
- **底部信息栏**：
  - 系统状态
  - 版权信息

#### 5.2.2 模块布局
- **设备监控模块**：
  - 左侧：设备列表和状态
  - 右侧：详细参数和趋势图
  - 底部：故障信息和建议
- **辅助维修模块**：
  - 上部：问答输入区
  - 中部：对话历史
  - 下部：备件查询区（预留）
- **工艺知识模块**：
  - 左侧：知识分类导航
  - 右侧：查询输入和结果展示

### 5.3 交互设计

#### 5.3.1 交互原则
- **即时反馈**：用户操作后立即给予视觉反馈
- **一致性**：相同功能的交互方式保持一致
- **容错性**：支持操作撤销和错误恢复
- **可访问性**：支持键盘操作和屏幕阅读器

#### 5.3.2 动效设计
- **过渡动画**：
  - 页面切换：淡入淡出效果
  - 数据更新：平滑过渡
  - 状态变化：渐变效果
- **微交互**：
  - 按钮悬停效果
  - 加载动画
  - 成功/失败提示动画

## 6. 非功能需求

### 6.1 性能要求
- **响应时间**：
  - 页面加载时间 < 3秒
  - API响应时间 < 2秒
  - 故障检测延迟 < 10秒
- **并发能力**：
  - 支持50+用户同时访问
  - 故障检测并发处理能力
- **资源占用**：
  - 内存使用优化
  - CPU使用率控制

### 6.2 可靠性要求
- **系统可用性**：99.9%以上
- **数据准确性**：故障检测准确率 > 95%
- **故障恢复**：自动故障恢复机制
- **数据备份**：重要数据定期备份

### 6.3 安全性要求
- **身份认证**：用户登录认证
- **权限控制**：基于角色的访问控制
- **数据安全**：敏感数据加密存储
- **操作审计**：关键操作日志记录

### 6.4 可维护性要求
- **模块化设计**：功能模块松耦合
- **代码规范**：统一的编码规范
- **文档完善**：技术文档和用户手册
- **监控告警**：系统运行状态监控

## 7. 部署要求

### 7.1 环境要求
- **开发环境**：
  - Node.js 16+
  - Python 3.8+
  - TDengine 2.0+
  - MySQL 8.0+
- **生产环境**：
  - Linux服务器
  - Nginx反向代理
  - Docker容器化部署

### 7.2 部署架构
- **前端部署**：
  - Nginx静态文件服务
  - CDN加速
- **后端部署**：
  - Dify平台服务
  - Python监控服务
- **数据库部署**：
  - TDengine集群（设备实时数据）
  - MySQL主从架构（报警记录和业务数据）
  - 数据备份策略

## 8. 项目计划

### 8.1 开发阶段
1. **需求分析与设计**（2周）
   - 需求文档编写
   - 技术方案设计
   - UI/UX设计

2. **核心功能开发**（4周）
   - 设备监控模块
   - Dify平台集成
   - TDengine数据集成

3. **辅助功能开发**（3周）
   - 辅助维修模块
   - 工艺知识模块
   - Markdown渲染优化

4. **测试与优化**（2周）
   - 功能测试
   - 性能优化
   - Bug修复

5. **部署与上线**（1周）
   - 环境部署
   - 用户培训
   - 系统上线

### 8.2 里程碑
- M1：需求文档确认完成
- M2：设备监控模块功能完成
- M3：Dify平台集成完成
- M4：全部功能开发完成
- M5：系统测试通过
- M6：正式上线运行

## 9. 风险评估

### 9.1 技术风险
- **Dify平台依赖**：平台稳定性影响系统功能
- **数据准确性**：TDengine数据质量影响故障检测
- **集成复杂度**：多系统集成可能存在兼容性问题

### 9.2 业务风险
- **用户接受度**：新系统使用习惯培养
- **知识库完善度**：影响问答质量
- **故障检测准确率**：直接影响系统价值

### 9.3 风险应对
- **技术预研**：关键技术提前验证
- **分步实施**：核心功能优先，逐步完善
- **用户培训**：加强培训和文档支持
- **持续优化**：基于反馈持续改进

## 10. 附录

### 10.1 术语表
- **TDengine**：时序数据库，用于存储设备运行数据
- **MySQL**：关系型数据库，用于存储报警记录和业务数据
- **Dify**：AI应用开发平台，提供大模型API服务
- **Markdown**：轻量级标记语言，用于格式化文本显示
- **API**：应用程序接口，用于系统间通信

### 10.2 参考文档
- Vue.js官方文档
- Dify平台API文档
- TDengine使用手册
- Markdown语法规范

### 10.3 设计稿（后续补充）
- 系统原型图
- UI设计稿
- 交互流程图

设备监控：
布局：分为左右两大块，左上是当前设备监控状态，左下是当前设备的参数，右边是一个提示框，用来当设备发生故障时触发调用AI模型分析并返回分析结果留以展示
功能：设备状态监控之前，用户需要绑定设备，需要选择设备型号和序号以及班次，有卷接机、包装机、封箱机，每个机型都有编号，从1#到22号，绑定成功以后才开始监控，未绑定之前界面只有表单，绑定成功以后才会跳出像上面布局那样
注意：
1. 设备正常运行时要有一个绿色的状态标识
2. 设备发生故障时要有一个红色的状态标识，并且要将当前的故障名称重点显示出来，然后右侧在AI分析结果出来之前要有正在等待中的标识

故障记录：
暂时没想好，可以先自行发挥

本班分析：
布局：就只有在正中间有一个大一点的开始分析按钮，用户点击要有一个特效，特效就是按钮有一个旋转的动画，旋转的过程中按钮的文字会变成“分析中”，分析完成以后按钮的文字会变成“分析完成”，然后下方显示出AI的分析结果，结果出来以后右上角要有一个关闭按钮，用户点击关闭按钮可以关闭分析结果的展示，点击关闭以后再退回来原来的界面

逻辑：原理逻辑就是当用户点击分析时，程序就会将本班次的所有故障调用AI大模型进行分析，然后返回结果