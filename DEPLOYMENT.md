# 生产环境部署指南

## 🚀 生产环境部署步骤

### 1. 前端部署

#### 1.1 构建前端应用

```bash
cd equipment-monitoring-system

# 安装依赖
pnpm install

# 构建生产版本（会自动使用 .env.production 配置）
pnpm build

# 预览构建结果（可选）
pnpm preview
```

#### 1.2 前端配置说明

- **开发环境**: 使用 `.env` 文件，API 地址为 `http://127.0.0.1:8000`
- **生产环境**: 使用 `.env.production` 文件，API 地址为 `http://10.43.32.231:8000`
- **访问地址**: `http://10.43.32.231:1130`

### 2. 后端部署

#### 2.1 启动后端服务

```bash
cd fastapi-backend/app

# 使用生产环境配置启动
python main_production.py
```

#### 2.2 后端配置说明

- **服务地址**: `10.43.32.231:8000`
- **API 文档**: `http://10.43.32.231:8000/docs`
- **支持跨域**: 已配置支持生产环境前端地址

### 3. 快速部署脚本

#### 3.1 Windows PowerShell

运行根目录下的 `deploy.ps1` 脚本：

```powershell
.\deploy.ps1
```

#### 3.2 手动部署

1. **后端启动**:

   ```bash
   cd fastapi-backend/app
   python main_production.py
   ```

2. **前端构建并启动**:
   ```bash
   cd equipment-monitoring-system
   pnpm build
   pnpm preview
   ```

### 4. 访问地址

- **前端应用**: http://10.43.32.231:1130
- **后端 API**: http://10.43.32.231:8000
- **API 文档**: http://10.43.32.231:8000/docs

### 5. 注意事项

1. **端口确保开放**: 确保防火墙允许 1130 和 8000 端口访问
2. **网络连通性**: 确保 10.43.32.231 在你的网络中可访问
3. **依赖检查**: 确保所有必要的依赖都已安装
4. **数据库连接**: 确保数据库配置正确且可连接

### 6. 常见问题排查

1. **跨域问题**: 检查后端 CORS 配置是否包含前端地址
2. **网络不通**: 检查 IP 地址和端口是否正确
3. **API 请求失败**: 检查后端服务是否正常运行
4. **构建失败**: 检查 Node.js 版本和依赖是否安装完整

### 7. 监控和日志

- 后端日志会输出到控制台
- 前端构建产物在 `dist` 目录
- 可以使用浏览器开发者工具查看网络请求状态
